CREATE DATABASE `BRAINPOT`;
USE `BRAINPOT`;


CREATE TABLE `USER` (
	  `ID` INT NOT NULL UNIQUE AUTO_INCREMENT,
    `TEAM` INT NOT NULL,
    `ADMIN` BOOLEAN NOT NULL,
    `NICKNAME` CHAR(10) NOT NULL,
    FOREIGN KEY(`TEAM`) REFERENCES `TEAM`(`ID`) ON UPDATE CASCADE ON DELETE CASCADE,

    KEY `IDX_ID`(`ID`)
);

#검색 쿼리
SELECT * FROM `USER`;

#샘플 데이터 삽입 쿼리문
INSERT INTO `USER`(`TEAM`, `ADMIN`, `NICKNAME`) VALUES (5, FALSE, 'Hyeri');

#어드민 유저 추가 스토어드 프로시저
DELIMITER @@;

CREATE PROCEDURE `ADD_ADMIN_USER`(IN `TEAM` INT, IN `NICKNAME` CHAR(10))

    BEGIN
        INSERT INTO `USER`(`TEAM`, `ADMIN`, `NICKNAME`) VALUES (`TEAM`, TRUE , `NICKNAME`);

    END @@;

DELIMITER ;

#프로시저 삭제
DROP PROCEDURE `ADD_ADMIN_USER`;
DROP PROCEDURE `ADD_NORMAL_USER`;

#어드민 유저 추가 스토어드 프로시저
DELIMITER @@;

CREATE PROCEDURE `ADD_NORMAL_USER`(IN `TEAM` INT, IN `NICKNAME` CHAR(10))

    BEGIN
        INSERT INTO `USER`(`TEAM`, `ADMIN`, `NICKNAME`) VALUES (`TEAM`, FALSE , `NICKNAME`);

    END @@;

DELIMITER ;

#스토어드 프로시저 호출
CALL `ADD_ADMIN_USER`(5, 'HYERI2');

#### DANGER!! ####
DROP TABLE `USER`;